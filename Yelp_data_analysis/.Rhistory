autoplot(kp_meier) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability') + guides(fill=guide_legend(title="Age at first vaccination"))
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Age at first vaccination")
kp_meier <- survfit(Surv(time, alzheimer) ~ age_interval, data = iv_data2)
ggsurvplot(kp_meier, legend.title = "Age at first vaccination")
autoplot(kp_meier, fill = guide_legend(title="Age at first vaccination")) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
ggsurvplot(kp_meier, legend.title = "Age at first vaccination")
ggsurvplot(kp_meier, legend.title = "Age at first vaccination", xlab = 'Time since first vaccination(Months)', ylab = 'AD free Probability')
new_data1 <- read.csv("~/Documents/2019_summer_intern/data/vaccine/Code for random selected cohort/Jupyter/new_data1.csv")
View(new_data1)
new_data <- new_data1
iv_data <- new_data[new_data$iv == 1, ]
iv_data2 <- iv_data[iv_data$gender_source_value == 'Male' | iv_data$gender_source_value == 'Female', ]
source('~/Documents/2019_summer_intern/data/vaccine/Code for random selected cohort/R code/plot.R', echo=TRUE)
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
library(survival)
library(ranger)
library(ggplot2)
library(dplyr)
library(ggfortify)
library(KMsurv)
library(survminer)
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1))
)
new_df$age_interval <- as.factor(levels(new_df$alcohol))
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
time <- iv_data2$iv_window1
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1))
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Age at first vaccination")
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1))
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(1, 2))
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = c('Male', 'Female'),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = c(0, 1),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = c(1, 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, new_data = new_df, data = iv_data2)
ggsurvplot(fit, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
fit <- survfit(cox_model2, new_data = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
plot(fit)
ncurve <- ncol(fit$surv)
ssurv <- tidyr::gather(as.data.frame(fit$surv), "strata", "surv")
ssurv$time <- rep(fit$time, ncurve )
ggplot(data = ssurv) + geom_step(aes(time, surv, color = strata))
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol")
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol") scale_color_discrete(breaks = c('0', '1'))
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol") + scale_color_discrete(breaks = c('0', '1'))
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol", legend.labs = c('0', '1'))
age_interval <- rep(0, 78518)
new_data <- new_data1
new_data$age_interval <- age_interval
for (i in 1 : 78518){
if (new_data$iv_age1[i] >= 50 & new_data$iv_age1[i] < 60){
new_data$age_interval[i] <- "[50, 60)"
}else if (new_data$iv_age1[i] >= 60 & new_data$iv_age1[i] < 70){
new_data$age_interval[i] <- "[60, 70)"
}else if (new_data$iv_age1[i] >= 70 & new_data$iv_age1[i] < 80){
new_data$age_interval[i] <- "[70, 80)"
}else if (new_data$iv_age1[i] >= 80 & new_data$iv_age1[i] < 90){
new_data$age_interval[i] <- "[80, 90)"
}else if (new_data$iv_age1[i] >= 90 & new_data$iv_age1[i] < 100){
new_data$age_interval[i] <- "[90, 100)"
}
}
iv_data <- new_data[new_data$iv == 1, ]
iv_data2 <- iv_data[iv_data$gender_source_value == 'Male' | iv_data$gender_source_value == 'Female', ]
time <- iv_data2$iv_window1
cox_model2 <- coxph(Surv(time, alzheimer) ~ age_interval + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(age_interval = c('[50, 60)','[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)'),
gender_source_value = rep('Male', 5),
obesity = rep(0, 5),
head_injury = rep(0, 5),
heart_disease = rep(0, 5),
smoke = rep(0, 5),
alcohol = rep(0, 5))
)
new_df$age_interval <- as.factor(levels(new_df$age_interval))
fit <- survfit(cox_model2, newdata = new_df, data = iv_data2)
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Age at first vaccination")
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv",
legend.title = "Age at first vaccination",
legend.labs = c('[50, 60)', '[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)'))
autoplot(kp_meier, fill = guide_legend(title="Age at first vaccination")) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
summary(cox_model2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = c(0, 1),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = c(0, 1),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))
# Heart disease -----------------------------------------------------------
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = c(0, 1),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1'))
iv_data <- new_data[new_data$iv == 1, ]
iv_data2 <- iv_data[iv_data$gender_source_value == 'Male' | iv_data$gender_source_value == 'Female', ]
time <- iv_data2$iv_window1
cox_model2 <- coxph(Surv(time, alzheimer) ~ age_interval + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(age_interval = c('[50, 60)','[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)'),
gender_source_value = rep('Male', 5),
obesity = rep(0, 5),
head_injury = rep(0, 5),
heart_disease = rep(0, 5),
smoke = rep(0, 5),
alcohol = rep(0, 5))
)
new_df$age_interval <- as.factor(levels(new_df$age_interval))
fit <- survfit(cox_model2, newdata = new_df, data = iv_data2)
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv",
legend.title = "Age at first vaccination",
legend.labs = c('[50, 60)', '[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)')) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = c(0, 1),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))+
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
# Heart disease -----------------------------------------------------------
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = c(0, 1),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability') + theme(legend.text = element_text(size = 14, color = "black", face = "bold"))
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1)
)
)
cox_model2 <- coxph(Surv(time, alzheimer) ~ age_interval + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(age_interval = c('[50, 60)','[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)'),
gender_source_value = rep('Male', 5),
obesity = rep(0, 5),
head_injury = rep(0, 5),
heart_disease = rep(0, 5),
smoke = rep(0, 5),
alcohol = rep(0, 5))
)
new_df$age_interval <- as.factor(levels(new_df$age_interval))
fit <- survfit(cox_model2, newdata = new_df, data = iv_data2)
ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv",
legend.title = "Age at first vaccination",
legend.labs = c('[50, 60)', '[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)')) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p1 <- ggsurvplot(fit, onf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv",
legend.title = "Age at first vaccination",
legend.labs = c('[50, 60)', '[60, 70)', '[70, 80)', '[80, 90)', '[90, 100)')) + xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p1$plot <- p1$plot +
theme(legend.text = element_text(size = 14, color = "black", face = "bold"))
p1
legend.title  = element_text(size = 18, color = "black", face = "bold")
p1
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
p1$plot <- p1$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold")  )
p1
p1$plot <- p1$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"))
p1
p1$plot <- p1$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p1
p1$plot <- p1$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p1
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1)
)
)
fit <- survfit(cox_model2, newdata = new_df)
ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p2$plot <- p2$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p2 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p2$plot <- p2$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p2
p3 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))+
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p3$plot <- p3$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p3
# Heart disease -----------------------------------------------------------
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = c(0, 1),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
p4 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p4$plot <- p3$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p4
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = c(0, 1),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
p3 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Obesity", legend.labs = c('0', '1'))+
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p3$plot <- p3$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p3
# Alcohol -----------------------------------------------------------------
cox_model2 <- coxph(Surv(time, alzheimer) ~ iv_age1 + gender_source_value + obesity + head_injury + heart_disease + smoke + alcohol, data = iv_data2)
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = rep(0, 2),
smoke = rep(0, 2),
alcohol = c(0, 1)
)
)
fit <- survfit(cox_model2, newdata = new_df)
p2 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Alcohol", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p2$plot <- p2$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p2
# Heart disease -----------------------------------------------------------
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = c(0, 1),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
p4 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p4$plot <- p3$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p4
source('~/Documents/2019_summer_intern/data/vaccine/Code for random selected cohort/R code/plot.R', echo=TRUE)
# Heart disease -----------------------------------------------------------
new_df <- with(iv_data2,
data.frame(iv_age1 = rep(mean(iv_age1), 2),
gender_source_value = rep('Male', 2),
obesity = rep(0, 2),
head_injury = rep(0, 2),
heart_disease = c(0, 1),
smoke = rep(0, 2),
alcohol = rep(0, 2)
)
)
fit <- survfit(cox_model2, newdata = new_df)
p4 <- ggsurvplot(fit, data = iv_data2, conf.int = TRUE, palette = "Dark2", censor = TRUE, surv.median.line = "hv", legend.title = "Heart disease", legend.labs = c('0', '1')) +
xlab('Time since the first vaccination(Months)') + ylab('AD-free Probability')
p4$plot <- p3$plot +
theme(legend.text = element_text(size = 18, color = "black", face = "bold"),
legend.title  = element_text(size = 18, color = "black", face = "bold"),
axis.text.x = element_text(size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size=22),
axis.title.x = element_text(size=22))
p4
shiny::runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
shiny::runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
runApp('Documents/course/Stat 628/Module3/Yelp_data_analysis')
